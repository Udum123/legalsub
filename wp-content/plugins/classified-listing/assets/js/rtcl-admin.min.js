!function(t){t.fn.getType=function(){return"INPUT"==this[0].tagName?this[0].type.toLowerCase():this[0].tagName.toLowerCase()};var e='<div class="rtcl-spinner block"><span class="rtcl-icon-spinner animate-spin"></span></div>';t(document.body).on("rtcl_add_error_tip",(function(e,i,r){var n=i.position();0===i.parent().find(".rtcl_error_tip").length&&(i.after('<div class="rtcl_error_tip '+r+'">'+rtcl[r]+"</div>"),i.parent().find(".rtcl_error_tip").css("left",n.left+i.width()-i.width()/2-t(".rtcl_error_tip").width()/2).css("top",n.top+i.height()).fadeIn("100"))})).on("rtcl_remove_error_tip",(function(e,i,r){i.parent().find(".rtcl_error_tip."+r).fadeOut("100",(function(){t(this).remove()}))})).on("click",(function(){t(".rtcl_error_tip").fadeOut("100",(function(){t(this).remove()}))})).on("blur","#rtcl-price[type=text],#rtcl-pricing-price[type=text], input.rtcl-price",(function(){t(".rtcl_error_tip").fadeOut("100",(function(){t(this).remove()}))})).on("keyup","#rtcl-price[type=text], #rtcl-pricing-price[type=text], input.rtcl-price",(function(){var e=t(this).attr("id"),i=rtcl.decimal_point,r="i18n_mon_decimal_error";"rtcl-pricing-price"===e&&(i=rtcl.pricing_decimal_point,r="i18n_mon_pricing_decimal_error");var n=new RegExp("[^-0-9%\\"+i+"]+","gi"),a=t(this).val(),c=a.replace(n,"");a!==c?t(document.body).triggerHandler("rtcl_add_error_tip",[t(this),r]):t(document.body).triggerHandler("rtcl_remove_error_tip",[t(this),r])})).on("change","#rtcl-price[type=text],#rtcl-pricing-price[type=text], input.rtcl-price",(function(){var e="rtcl-pricing-price"===t(this).attr("id")?rtcl.pricing_decimal_point:rtcl.decimal_point,i=new RegExp("[^-0-9%\\"+e+"]+","gi"),r=t(this).val(),n=r.replace(i,"");r!==n&&t(this).val(n)})).on("rtcl_price_type_changed",(function(e,i){"on_call"===i.value||"free"===i.value||"no_price"===i.value?t("#rtcl-price").attr("required","false").val(""):t("#rtcl-price").attr("required","true"),t("#rtcl-price-items").removeClass((function(t,e){return(e.match(/(^|\s)rtcl-price-type\S+/g)||[]).join(" ")})).addClass("rtcl-price-type-"+i.value)})).on("rtcl_listing_pricing_type_changed",(function(e,i){t("#rtcl-pricing-items").removeClass().addClass("rtcl-pricing-"+i.value)})).on("change","#rtcl-price-type",(function(){t(document.body).trigger("rtcl_price_type_changed",[this])})).on("change","input[name=_rtcl_listing_pricing]",(function(){t(document.body).trigger("rtcl_listing_pricing_type_changed",[this])}));var i=function(e){this._target=e,this.timestampdiv=t(".rtcl-timestamp-div",this._target),this.timestamp=t(".rtcl-timestamp",this._target),this.stamp=this.timestamp.html(),this.timestampwrap=this.timestampdiv.find(".timestamp-wrap"),this.edittimestamp=this.timestampdiv.siblings("a.edit-timestamp"),this.init=function(){var e=this;this.edittimestamp.on("click",(function(i){e.timestampdiv.is(":hidden")&&(e.timestampdiv.slideDown("fast",(function(){t("input, select",e.timestampwrap).first().focus()})),t(this).hide()),i.preventDefault()})),this.timestampdiv.find(".cancel-timestamp").on("click",(function(t){e.edittimestamp.show().focus(),e.timestampdiv.slideUp("fast"),e.timestampdiv.find(".rtcl-mm").val(e.timestampdiv.find(".rtcl-hidden_mm").val()),e.timestampdiv.find(".rtcl-jj").val(e.timestampdiv.find(".rtcl-hidden_jj").val()),e.timestampdiv.find(".rtcl-aa").val(e.timestampdiv.find(".rtcl-hidden_aa").val()),e.timestampdiv.find(".rtcl-hh").val(e.timestampdiv.find(".rtcl-hidden_hh").val()),e.timestampdiv.find(".rtcl-mn").val(e.timestampdiv.find(".rtcl-hidden_mn").val()),e.timestamp.html(e.stamp),t.preventDefault()})),this.timestampdiv.find(".save-timestamp").on("click",(function(i){var r=e.timestampdiv.find(".rtcl-aa").val(),n=e.timestampdiv.find(".rtcl-mm").val(),a=e.timestampdiv.find(".rtcl-jj").val(),c=e.timestampdiv.find(".rtcl-hh").val(),l=e.timestampdiv.find(".rtcl-mn").val(),o=new Date(r,n-1,a,c,l);i.preventDefault(),o.getFullYear()==r&&1+o.getMonth()==n&&o.getDate()==a&&o.getMinutes()==l?(e.timestampwrap.removeClass("form-invalid"),e.timestamp.html(rtcl.expiredOn+" <b>"+rtcl.dateFormat.replace("%1$s",t('option[value="'+n+'"]',"#mm").attr("data-text")).replace("%2$s",parseInt(a,10)).replace("%3$s",r).replace("%4$s",("00"+c).slice(-2)).replace("%5$s",("00"+l).slice(-2))+"</b> "),e.edittimestamp.show().focus(),e.timestampdiv.slideUp("fast")):e.timestampwrap.addClass("form-invalid")}))},this.init()};t.fn.rtcl_time_stamp=function(){t(this).each((function(){return new i(t(this))}))},t(".rtcl-timestamp-wrapper").rtcl_time_stamp(),t(".misc-pub-rtcl-never-expires").on("click","input",(function(){t(this).is(":checked")?t(".misc-pub-rtcl-expiration-time").hide():t(".misc-pub-rtcl-expiration-time").show()})),t("#rtcl-ad-type").on("change",(function(){var i=t(this),r=i.val(),n=t("#rtcl-category-wrap"),a=t("#rtcl-price-items"),c=t('<select class="form-control" id="rtcl-category-of-type" name="rtcl-category-of-type" required />');if(a.find(".price-label .rtcl-per-unit").remove(),"to_let"===r){var l=a.find("label").attr("data-per-unit");a.find(".price-label").append('<span class="rtcl-per-unit"> / '+l+"</span>")}if(""===r?t("#rtcl-pricing-wrap").slideUp(250):t("#rtcl-pricing-wrap").slideDown(250),r){var o={action:"rtcl_get_one_level_category_select_list_by_type",type:r};t.ajax({url:rtcl.ajaxurl,data:o,type:"POST",beforeSend:function(){t(e).insertAfter(i),t("#rtcl-custom-fields-list").html(""),n.html(c)},success:function(t){i.next(".rtcl-spinner").remove(),t.success&&n.html(c.append(t.cats))},error:function(t){i.next(".rtcl-spinner").remove(),console.log(t.responseText)}})}else t("#rtcl-custom-fields-list").html(""),n.html(c)})),t(document).on("change","#rtcl-category-wrap select",(function(){var i=t(this),r=i.parents("#rtcl-category-wrap"),n=t("#rtcl-category-input"),a=t("#rtcl-custom-fields-list"),c=t(this).val(),l=t("<div class='alert rtcl-response'></div>"),o={action:"rtcl_custom_fields_listings",post_id:t("#rtcl-custom-fields-list").data("post_id"),term_id:c,is_admin:rtcl.is_admin};c?(n.val(c),t.ajax({url:rtcl.ajaxurl,data:o,type:"POST",dataType:"json",beforeSend:function(){t(e).insertAfter(i),r.find(".alert.rtcl-response").remove(),i.nextAll("select").remove()},success:function(e){r.find(".rtcl-spinner").remove(),e.child_cats&&r.append(t('<select class="form-control" id="rtcl-category-of-'+c+'" name="rtcl-category-of-'+c+'" required />').append(e.child_cats)),a.html(e.custom_fields),rtclInitDateField(),rtclRenderCFfConditions()},error:function(t){r.find(".rtcl-spinner").remove(),l.removeClass("alert-success").addClass("alert-danger").html(t.responseText).appendTo(r)}})):i.nextAll("select").remove(),function(e){var i=t("#rtcl-price-items"),r=t("#rtcl-price-unit-wrap",i),n=r.length,a={action:"rtcl_get_price_units_ajax",term_id:e||0};t.ajax({url:ajaxurl,data:a,type:"POST",dataType:"json",beforeSend:function(){},success:function(t){t.html?(n&&r.remove(),i.append(t.html)):r.remove()},error:function(){}})}(c)})),t.fn.validate&&(t(".post-type-rtcl_listing #post").validate(),t(".post-type-rtcl_pricing #post").validate()),t("#send-email-to-user").on("click",(function(e){e.preventDefault();var i=t('<div style="display:none;height:450px;" id="user-message"><div class="form-group"><textarea class="rtcl-form-control" rows="6"></textarea></div><a class="message-send button button-primary button-large">Send</a></div>').appendTo("body");return i.dialog({close:function(t,e){i.remove()},open:function(e,i){t("#user-message").parent(".ui-dialog").css("zIndex",9999).nextAll(".ui-widget-overlay").css("zIndex",9998)},closeText:!1,modal:!0,maxWidth:850,zIndex:9999,maxHeight:.9*t(window).height(),title:"Message",position:{my:"center top+50",at:"center top",of:window}}),i.on("click","a.message-send",(function(e){e.preventDefault();var r=t(this),n=t("#post_ID").val(),a=i.find("textarea").val();if(n&&a){var c={action:"rtcl_send_email_to_user_by_moderator",post_id:n,message:a,__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({type:"POST",url:rtcl.ajaxurl,data:c,beforeSend:function(){t(".rtcl-flash-messages").remove(),r.addClass("disabled").attr("disabled","disabled"),t('<span class="rtcl-icon-spinner animate-spin"></span>').insertAfter(r)},success:function(e){r.removeClass("disabled"),t(".rtcl-icon-spinner",i).remove();var n=t("<div class='rtcl-flash-messages'>"+e.message+"</div>");n.insertAfter(r),n.addClass(e.class),e.error?r.removeAttr("disabled"):setTimeout((function(){i.dialog("close")}),1e3)},error:function(e,n){t(".rtcl-icon-spinner",i).remove(),i.dialog("close"),r.removeAttr("disabled"),0===e.status?alert("Not connect.\n Verify Network."):404==e.status?alert("Requested page not found. [404]"):500==e.status?alert("Internal Server Error [500]."):"parsererror"===n?alert("Requested JSON parse failed."):"timeout"===n?alert("Time out error."):"abort"===n?alert("Ajax request aborted."):alert("Uncaught Error.\n"+e.responseText)}})}else alert("Please add some message!!");return!1})),!1})),window.rtclInitDateField=function(){t.fn.daterangepicker&&t(".rtcl-date").each((function(){var e=t(this),i=e.data("options")||{};e.daterangepicker(i),!1===i.autoUpdateInput&&e.on("apply.daterangepicker",(function(e,i){t(this).val(i.startDate.format(i.locale.format))}))}))},t((function(){t("#rtcl-overwrite").on("change",(function(){t(".rtcl-overwrite-item").find("input");this.checked?t(".rtcl-overwrite-item").each((function(){t(this).data("id");var e=t(this).find("input"),i=t(".rtcl-overwrite-sub-item_"+t(this).data("id"));e.prop("disabled",!1),e.is(":checked")?i.find("input").prop("disabled",!1):i.find("input").prop("disabled",!0)})):t(".rtcl-overwrite-item").each((function(){t(this).data("id");var e=t(this).find("input"),i=t(".rtcl-overwrite-sub-item_"+t(this).data("id"));e.prop("disabled",!0),i.find("input").prop("disabled",!0)}))})),t(".rtcl-overwrite-item input").on("change",(function(){var e=t(this).attr("name"),i=t(".rtcl-overwrite-sub-item_"+e);t(this).is(":checked")?i.find("input").prop("disabled",!1):i.find("input").prop("disabled",!0)})),rtclInitDateField(),t.fn.select2&&(t(".rtcl-select2").select2({dropdownAutoWidth:!0,width:"100%"}),t.fn.select2&&(t(".rtcl-select2").select2({dropdownAutoWidth:!0,width:"100%"}),t(".rtcl-ajax-select").each((function(){var e={allowClear:!!t(this).data("allow_clear"),placeholder:t(this).data("placeholder")||"",minimumInputLength:t(this).data("minimum_input_length")?t(this).data("minimum_input_length"):"1",escapeMarkup:function(t){return t},ajax:{url:rtcl.ajaxurl,type:"POST",dataType:"json",delay:1e3,data:function(e){return{term:e.term,type:t(this).data("type")||"",action:t(this).data("action")||"rtcl_json_search_taxonomy",__rtcl_wpnonce:rtcl.__rtcl_wpnonce}},processResults:function(e){var i=[];return e&&t.each(e,(function(t,e){i.push({id:e.id,text:e.text||e.label})})),{results:i}},cache:!0}};if(t(this).select2(e).addClass("enhanced"),t(this).data("sortable")){var i=t(this),r=t(this).next(".select2-container").find("ul.select2-selection__rendered");r.sortable({placeholder:"ui-state-highlight select2-selection__choice",forcePlaceholderSize:!0,items:"li:not(.select2-search__field)",tolerance:"pointer",stop:function(){t(r.find(".select2-selection__choice").get().reverse()).each((function(){var e=t(this).data("data").id,r=i.find('option[value="'+e+'"]')[0];i.prepend(r)}))}})}})))),t("#expiry-date").length&&t("#expiry-date").datetimepicker(),t("#rtcl-location").on("change",(function(){var i=t(this),r={action:"rtcl_get_sub_location_options",term_id:t(this).val(),blank:!0};t.ajax({url:ajaxurl,data:r,type:"POST",beforeSend:function(){t(e).insertAfter(i)},success:function(e){i.next(".rtcl-spinner").remove(),t("#rtcl-sub-location").html(e.locations),t("#rtcl-sub-sub-location").html("").addClass("rtcl-hide"),e.locations?t("#sub-location-row").removeClass("rtcl-hide"):t("#sub-location-row").addClass("rtcl-hide")},error:function(){i.next(".rtcl-spinner").remove()}})})),t("#rtcl-sub-location").on("change",(function(){var i=t(this),r={action:"rtcl_get_sub_location_options",term_id:t(this).val(),blank:!0};t.ajax({url:ajaxurl,data:r,type:"POST",beforeSend:function(){t(e).insertAfter(i)},success:function(e){i.next(".rtcl-spinner").remove(),t("#rtcl-sub-sub-location").html(e.locations),e.locations?t("#sub-sub-location-row").removeClass("rtcl-hide"):t("#sub-sub-location-row").addClass("rtcl-hide")},error:function(){i.next(".rtcl-spinner").remove()}})})),t("body").hasClass("post-type-rtcl_listing")&&function(){if(void 0===window.wp.autosave)return;var e={post_title:t("#title").val()||"",content:t("#content").val()||"",excerpt:t("#excerpt").val()||""},i=window.wp.autosave.getCompareString(e);window.wp.autosave.server.postChanged=function(){var r=!1;return window.tinymce?(window.tinymce.each(["content","excerpt"],(function(i){var n=window.tinymce.get(i);if(!n||n.isHidden()){if((t("#"+i).val()||"")!==e[i])return r=!0,!1}else if(n.isDirty())return r=!0,!1})),(t("#title").val()||"")!==e.post_title&&(r=!0),r):window.wp.autosave.getCompareString()!==i}}()}))}(jQuery),function(t){var e;function i(){t(".ui-dialog").each((function(){t(this).css({maxWidth:"100%",zIndex:9999,top:t(window).scrollTop()+50+"px",left:(t("body").innerWidth()-t(this).outerWidth())/2+"px"})}))}t(document).on("dialogopen",".ui-dialog",(function(e,i){t("button.button-primary, button.wpcf-ui-dialog-cancel").blur().addClass("button").removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only")})),t(window).on("resize scroll",(function(){clearTimeout(e),e=setTimeout(i,200)})),{init:function(){t("#rtcl-order-notes").on("click","button.add-note",this.add_order_note).on("click","a.delete_note",this.delete_order_note)},add_order_note:function(){var e=t("textarea#rtcl-add-payment-note");if(e.val()){t("#rtcl-order-notes").rtclBlock();var i={action:"rtcl_add_order_note",post_id:parseInt(t("#post_ID").val(),10)||0,note:e.val(),note_type:t("select#rtcl-order-note-type").val(),__rtcl_wpnonce:rtcl.__rtcl_wpnonce};return t.post(rtcl.ajaxurl,i,(function(e){t("ul.rtcl_payment_notes").prepend(e.html),t("#rtcl-order-notes").rtclUnblock(),t("#rtcl-add-payment-note").val("")})),!1}},delete_order_note:function(){if(window.confirm(rtcl.i18n_delete_note)){var e=t(this).closest("li.note");t(e).rtclBlock();var i={action:"rtcl_delete_order_note",note_id:t(e).attr("rel"),__rtcl_wpnonce:rtcl.__rtcl_wpnonce};t.ajax({url:rtcl.ajaxurl,data:i,type:"POST",dataType:"json",beforeSend:function(){},success:function(i){i.success&&t(e).remove()}})}return!1}}.init()}(jQuery);
