!function(e){e(document).on("click",".listing-type .action span.edit",(function(){e(this).parents("li").find(".edit-action").slideToggle()})),e("#input-new-type-form").on("submit",(function(a){a.preventDefault();var t=e(this),s=e(t),l=e("#rtcl-add-btn",s),n=e("#add-input-type",s),i=n.val(),d=(e("#_rt_rtcl_disable_price",s).val(),new FormData(this));d.append("action","rtcl_ajax_add_listing_type"),d.append(rtcl.nonceId,rtcl.nonce),s.find(".alert").remove(),i?e.ajax({url:rtcl.ajaxurl,cache:!1,processData:!1,contentType:!1,data:d,dataType:"json",type:"POST",beforeSend:function(){l.addClass("spinner rtcl-loading").prop("disabled",!0)},success:function(a){a.success&&(n.val(""),function(a){var t=function(e){var a='<li class="list-group-item listing-type" data-id="'+e.id+'"><div class="type-details d-flex"><div class="type-info"><div class="type-info-id">'+e.id+'</div><div class="type-info-name">'+e.name+'</div></div><div class="action ml-auto"><span class="btn btn-success btn-sm edit">Edit</span><span class="btn btn-danger btn-sm  delete">Delete</span></div></div><div class="edit-action"><form class="row input-update-type-form"><div class="form-group col-6"><label>ID</label><input type="text" name="id" class="form-control" value="'+e.id+'" ></div><div class="form-group col-6"><label>Type</label><input type="text" name="name" class="form-control" value="'+e.name+'" ></div><div class="form-group col-12"><button class="btn btn-primary btn-sm w-100">Update</button></div></form></div></div></li>';return a}(a),s=e("#rtcl-listing-type-wrap"),l=e(s,"#listing-types");l.length||(l=e("<ul id='listing-types' class='list-group' />"),s.html(l));l.append(t)}(a.data));var t=a.success?"alert-success":"alert-danger",i=e('<div class="col-12 alert alert-dismissible fade show" role="alert" />').append(a.message);i.addClass(t),s.append(i),l.removeClass("spinner rtcl-loading").prop("disabled",!1)},error:function(a){e('<div class="col-12 alert alert-danger alert-dismissible fade show" role="alert" />').append("Server Error !!!").appendTo(s),l.removeClass("spinner rtcl-loading").prop("disabled",!1)}}):(e('<div class="alert alert-danger alert-dismissible fade show" role="alert" />').append("Please fill type.").appendTo(s),n.focus())})),e(document).on("submit",".input-update-type-form",(function(a){a.preventDefault();var t=e(this),s=t.closest("li"),l=s.data("id")||"",n=e(".type-info-id",s),i=e(".type-info-name",s),d=t.find("button[type=submit]"),r=t.find("input[name=id]"),o=r.val()||"",c=t.find("input[name=name]"),p=c.val()||"",u=new FormData(this);u.append("action","rtcl_ajax_update_listing_type"),u.append("old_id",l),u.append(rtcl.nonceId,rtcl.nonce),t.find(".alert").remove(),o&&p&&l?e.ajax({url:rtcl.ajaxurl,cache:!1,processData:!1,contentType:!1,data:u,dataType:"json",type:"POST",beforeSend:function(){d.addClass("spinner rtcl-loading").prop("disabled",!0),t.find(".alert").remove()},success:function(a){r.val(a.data.id),c.val(a.data.name),a.success&&(n.text(a.data.id),i.text(a.data.name),s.data("id",a.data.id)),d.removeClass("spinner rtcl-loading").prop("disabled",!1);var l=a.success?"alert-success":"alert-danger",o=e('<div class="col-12 alert alert-dismissible fade show" role="alert" />').append(a.message);o.addClass(l),t.append(o)},error:function(a){console.log(a),e('<div class="col-12 alert alert-danger alert-dismissible fade show" role="alert" />').append("Server Error !!!").appendTo(t),d.removeClass("spinner rtcl-loading").prop("disabled",!1)}}):e('<div class="col-12 alert alert-danger alert-dismissible fade show" role="alert" />').append("Please fill id and type.").appendTo(t)})),e(document).on("click",".listing-type .action span.delete:not(.disabled)",(function(){if(confirm("Are you sure to delete this type?")){var a=e(this),t=a.parents("li.listing-type"),s=t.data("id");if(s){var l={action:"rtcl_ajax_delete_listing_type",id:s};l[rtcl.nonceId]=rtcl.nonce,e.ajax({url:rtcl.ajaxurl,data:l,type:"POST",beforeSend:function(){a.addClass("spinner rtcl-loading disabled").prop("disabled",!1)},success:function(s){s.success?t.slideUp("slow",(function(){e(this).remove()})):(a.removeClass("spinner rtcl-loading disabled").prop("disabled",!1),alert(s.message))},error:function(e){a.removeClass("spinner rtcl-loading disabled").prop("disabled",!1),console.log(e)}})}else alert("Type id is required.")}}))}(jQuery);
